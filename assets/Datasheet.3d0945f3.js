import{g as R,a as D,s as g,P as L,r as C,u as w,_ as H,b as m,j as t,c as A,d as _,T as M,e as u,f as U,i as B,h as q,k as j,I as k,C as p,l as W,A as z,F,B as S,L as G,m as V}from"./index.e3c54621.js";import{T as E,M as X}from"./Modal.b4ba2bd4.js";import{M as J,C as K,i as Q,D as I}from"./datasheet.service.06afcdd5.js";import{M as Y}from"./Menu.31726533.js";import"./requestHandler.service.751a06e3.js";function Z(e){return R("MuiCard",e)}D("MuiCard",["root"]);const ee=["className","raised"],te=e=>{const{classes:a}=e;return _({root:["root"]},Z,a)},ae=g(L,{name:"MuiCard",slot:"Root",overridesResolver:(e,a)=>a.root})(()=>({overflow:"hidden"})),se=C.exports.forwardRef(function(a,s){const o=w({props:a,name:"MuiCard"}),{className:i,raised:r=!1}=o,h=H(o,ee),l=m({},o,{raised:r}),d=te(l);return t(ae,m({className:A(d.root,i),elevation:r?8:void 0,ref:s,ownerState:l},h))}),re=se;function oe(e){return R("MuiCardContent",e)}D("MuiCardContent",["root"]);const ne=["className","component"],ce=e=>{const{classes:a}=e;return _({root:["root"]},oe,a)},ie=g("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(e,a)=>a.root})(()=>({padding:16,"&:last-child":{paddingBottom:24}})),le=C.exports.forwardRef(function(a,s){const o=w({props:a,name:"MuiCardContent"}),{className:i,component:r="div"}=o,h=H(o,ne),l=m({},o,{component:r}),d=ce(l);return t(ie,m({as:r,className:A(d.root,i),ownerState:l,ref:s},h))}),de=le;function pe(e){return R("MuiCardHeader",e)}const he=D("MuiCardHeader",["root","avatar","action","content","title","subheader"]),P=he,ue=["action","avatar","className","component","disableTypography","subheader","subheaderTypographyProps","title","titleTypographyProps"],me=e=>{const{classes:a}=e;return _({root:["root"],avatar:["avatar"],action:["action"],content:["content"],title:["title"],subheader:["subheader"]},pe,a)},Ce=g("div",{name:"MuiCardHeader",slot:"Root",overridesResolver:(e,a)=>m({[`& .${P.title}`]:a.title,[`& .${P.subheader}`]:a.subheader},a.root)})({display:"flex",alignItems:"center",padding:16}),fe=g("div",{name:"MuiCardHeader",slot:"Avatar",overridesResolver:(e,a)=>a.avatar})({display:"flex",flex:"0 0 auto",marginRight:16}),ve=g("div",{name:"MuiCardHeader",slot:"Action",overridesResolver:(e,a)=>a.action})({flex:"0 0 auto",alignSelf:"flex-start",marginTop:-4,marginRight:-8,marginBottom:-4}),xe=g("div",{name:"MuiCardHeader",slot:"Content",overridesResolver:(e,a)=>a.content})({flex:"1 1 auto"}),ge=C.exports.forwardRef(function(a,s){const o=w({props:a,name:"MuiCardHeader"}),{action:i,avatar:r,className:h,component:l="div",disableTypography:d=!1,subheader:n,subheaderTypographyProps:y,title:v,titleTypographyProps:c}=o,T=H(o,ue),f=m({},o,{component:l,disableTypography:d}),x=me(f);let N=v;N!=null&&N.type!==M&&!d&&(N=t(M,m({variant:r?"body2":"h5",className:x.title,component:"span",display:"block"},c,{children:N})));let b=n;return b!=null&&b.type!==M&&!d&&(b=t(M,m({variant:r?"body2":"body1",className:x.subheader,color:"text.secondary",component:"span",display:"block"},y,{children:b}))),u(Ce,m({className:A(x.root,h),as:l,ref:s,ownerState:f},T,{children:[r&&t(fe,{className:x.avatar,ownerState:f,children:r}),u(xe,{className:x.content,ownerState:f,children:[N,b]}),i&&t(ve,{className:x.action,ownerState:f,children:i})]}))}),ye=ge;var $={},Ne=B.exports;Object.defineProperty($,"__esModule",{value:!0});var O=$.default=void 0,be=Ne(U()),Se=q,Me=(0,be.default)((0,Se.jsx)("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"}),"MoreVert");O=$.default=Me;const Te=({datasheet:e,actions:a})=>{var y,v;const{t:s}=j(),o=a?Object.keys(a):void 0,[i,r]=C.exports.useState(null),h=Boolean(i),l=c=>{r(c.currentTarget)},d=()=>{r(null)},n=()=>{var c;return((c=e.workmanship)==null?void 0:c.reduce((T,f)=>T+f.value,0))+e.weight*e.metals.silver.price};return u(re,{sx:{maxWidth:300},children:[t(ye,{action:t(k,{"aria-label":"settings","aria-controls":h?"basic-menu":void 0,"aria-haspopup":"true","aria-expanded":h?"true":void 0,onClick:l,children:t(O,{})}),title:e.code}),t(Y,{id:"basic-menu",anchorEl:i,open:h,onClose:d,MenuListProps:{"aria-labelledby":"basic-button"},children:a&&o&&o.map(c=>t(J,{onClick:()=>{d(),a[c].action(e._id)},children:a[c].icon},c))}),t(K,{sx:{p:1,width:300,height:300},component:"img",image:(y=e.image)!=null?y:Q,alt:"img"}),t(de,{className:"card-datasheet",sx:{p:1},children:t("table",{children:u("tbody",{children:[u("tr",{className:"card-datasheet",children:[t("td",{children:s(p.SILVER)}),t(E,{title:s(p.WEIGHT),children:t("td",{className:"text-rigth",children:e.weight})}),t(E,{title:s(p.PRICE),children:t("td",{className:"text-rigth",children:e.metals.silver.price})}),t("td",{className:"text-rigth",children:e.metals.silver.price*e.weight})]}),(v=e.workmanship)==null?void 0:v.map(c=>u("tr",{className:"card-datasheet",children:[t("td",{colSpan:3,children:c.name.toUpperCase()}),t("td",{className:"text-rigth",children:c.value})]},c.name)),u("tr",{className:"card-datasheet",children:[t("td",{colSpan:3,children:s(p.TOTAL)}),t("td",{className:"text-rigth",children:n()})]}),u("tr",{className:"card-datasheet",children:[t("td",{children:s(p.EXPENSES)}),t("td",{className:"text-rigth",children:e.expenses}),t("td",{className:"text-rigth",children:n()*e.expenses/100}),t("td",{className:"text-rigth",children:n()*e.expenses/100+n()})]}),u("tr",{className:"card-datasheet",children:[t("td",{colSpan:3,children:s(p.PRICE_SALE)}),t("td",{className:"text-rigth",children:(n()*e.expenses/100+n())*2})]})]})})})]})},Ee=()=>{const e=W(),[a,s]=C.exports.useState([]),[o,i]=C.exports.useState(""),r=async()=>{const n=await I.getAll();n&&s(n)},h=async n=>{await I.delete(n)&&(s(v=>v.filter(c=>c._id!==n)),i(""))},l={cancel:{action:()=>i("")},confirm:{action:n=>h(n)}},d={edit:{icon:p.ICONS.EDIT,action:n=>e(n)},delete:{icon:p.ICONS.DELETE,action:n=>i(n)}};return C.exports.useEffect(()=>{r()},[]),C.exports.useEffect(()=>()=>{z.reset()}),{datasheets:a,deleteDatasheet:o,actionsModal:l,actionsCard:d}};const _e=()=>{const{t:e}=j(),{datasheets:a,deleteDatasheet:s,actionsModal:o,actionsCard:i}=Ee();return u(F,{children:[t(S,{display:"flex",justifyContent:"flex-end",children:t(G,{to:"new",children:t(E,{title:`${e(p.CREATE)}  ${e(p.DATASHEET)}`,children:t(k,{children:p.ICONS.ADD})})})}),t(S,{display:"flex",flexWrap:"wrap",justifyContent:"center",children:a.map(r=>t(S,{sx:{m:2},children:t(Te,{datasheet:r,actions:i})},r._id))}),s&&t(X,{isOpen:!!s,handlerClose:o.cancel.action,children:u(S,{children:[t(M,{component:"div",sx:{flexGrow:1},children:e(p.MESSAGE_ACTIONS.DELETE)}),t(S,{className:"actions-modal",children:o&&Object.keys(o).map(r=>t(V,{variant:"contained",onClick:()=>o[r].action(s),children:e(r)},r))})]})})]})};export{_e as Datasheet};
