import{g as D,a as w,s as v,P as O,r as m,u as R,_ as A,b as h,j as t,c as E,d as H,T as S,e as p,f as k,i as U,h as L,I as j,k as B,A as q,C as f,F as z,B as M,L as F,l as V}from"./index.bf687cd6.js";import{T as W,M as G}from"./Modal.dfb7abdd.js";import{M as J,C as K,i as Q,D as P}from"./datasheet.service.ea20e888.js";import{M as X}from"./Menu.faf45ba4.js";import"./requestHandler.service.ff713010.js";function Y(e){return D("MuiCard",e)}w("MuiCard",["root"]);const Z=["className","raised"],ee=e=>{const{classes:a}=e;return H({root:["root"]},Y,a)},te=v(O,{name:"MuiCard",slot:"Root",overridesResolver:(e,a)=>a.root})(()=>({overflow:"hidden"})),ae=m.exports.forwardRef(function(a,r){const o=R({props:a,name:"MuiCard"}),{className:s,raised:n=!1}=o,u=A(o,Z),d=h({},o,{raised:n}),c=ee(d);return t(te,h({className:E(c.root,s),elevation:n?8:void 0,ref:r,ownerState:d},u))}),se=ae;function re(e){return D("MuiCardContent",e)}w("MuiCardContent",["root"]);const oe=["className","component"],ne=e=>{const{classes:a}=e;return H({root:["root"]},re,a)},ce=v("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(e,a)=>a.root})(()=>({padding:16,"&:last-child":{paddingBottom:24}})),ie=m.exports.forwardRef(function(a,r){const o=R({props:a,name:"MuiCardContent"}),{className:s,component:n="div"}=o,u=A(o,oe),d=h({},o,{component:n}),c=ne(d);return t(ce,h({as:n,className:E(c.root,s),ownerState:d,ref:r},u))}),le=ie;function de(e){return D("MuiCardHeader",e)}const pe=w("MuiCardHeader",["root","avatar","action","content","title","subheader"]),_=pe,ue=["action","avatar","className","component","disableTypography","subheader","subheaderTypographyProps","title","titleTypographyProps"],he=e=>{const{classes:a}=e;return H({root:["root"],avatar:["avatar"],action:["action"],content:["content"],title:["title"],subheader:["subheader"]},de,a)},me=v("div",{name:"MuiCardHeader",slot:"Root",overridesResolver:(e,a)=>h({[`& .${_.title}`]:a.title,[`& .${_.subheader}`]:a.subheader},a.root)})({display:"flex",alignItems:"center",padding:16}),Ce=v("div",{name:"MuiCardHeader",slot:"Avatar",overridesResolver:(e,a)=>a.avatar})({display:"flex",flex:"0 0 auto",marginRight:16}),fe=v("div",{name:"MuiCardHeader",slot:"Action",overridesResolver:(e,a)=>a.action})({flex:"0 0 auto",alignSelf:"flex-start",marginTop:-4,marginRight:-8,marginBottom:-4}),ve=v("div",{name:"MuiCardHeader",slot:"Content",overridesResolver:(e,a)=>a.content})({flex:"1 1 auto"}),xe=m.exports.forwardRef(function(a,r){const o=R({props:a,name:"MuiCardHeader"}),{action:s,avatar:n,className:u,component:d="div",disableTypography:c=!1,subheader:i,subheaderTypographyProps:x,title:l,titleTypographyProps:g}=o,T=A(o,ue),y=h({},o,{component:d,disableTypography:c}),C=he(y);let N=l;N!=null&&N.type!==S&&!c&&(N=t(S,h({variant:n?"body2":"h5",className:C.title,component:"span",display:"block"},g,{children:N})));let b=i;return b!=null&&b.type!==S&&!c&&(b=t(S,h({variant:n?"body2":"body1",className:C.subheader,color:"text.secondary",component:"span",display:"block"},x,{children:b}))),p(me,h({className:E(C.root,u),as:d,ref:r,ownerState:y},T,{children:[n&&t(Ce,{className:C.avatar,ownerState:y,children:n}),p(ve,{className:C.content,ownerState:y,children:[N,b]}),s&&t(fe,{className:C.action,ownerState:y,children:s})]}))}),ge=xe;var $={},ye=U.exports;Object.defineProperty($,"__esModule",{value:!0});var I=$.default=void 0,Ne=ye(k()),be=L,Me=(0,Ne.default)((0,be.jsx)("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"}),"MoreVert");I=$.default=Me;const Se=({datasheet:e,actions:a})=>{var i,x;const r=a?Object.keys(a):void 0,[o,s]=m.exports.useState(null),n=Boolean(o),u=l=>{s(l.currentTarget)},d=()=>{s(null)},c=()=>{var l;return((l=e.workmanship)==null?void 0:l.reduce((g,T)=>g+T.value,0))+e.weight*e.metals.silver.price};return p(se,{sx:{maxWidth:300},children:[t(ge,{action:t(j,{"aria-label":"settings","aria-controls":n?"basic-menu":void 0,"aria-haspopup":"true","aria-expanded":n?"true":void 0,onClick:u,children:t(I,{})}),title:e.code}),t(X,{id:"basic-menu",anchorEl:o,open:n,onClose:d,MenuListProps:{"aria-labelledby":"basic-button"},children:a&&r&&r.map(l=>t(J,{onClick:()=>{d(),a[l].action(e.id)},children:a[l].icon},l))}),t(K,{sx:{p:1,width:300,height:300},component:"img",image:(i=e.image)!=null?i:Q,alt:"img"}),t(le,{className:"card-datasheet",sx:{p:1},children:t("table",{children:p("tbody",{children:[p("tr",{className:"card-datasheet",children:[t("td",{children:"PLATA"}),t("td",{className:"text-rigth",children:e.weight}),t("td",{className:"text-rigth",children:e.metals.silver.price}),t("td",{className:"text-rigth",children:e.metals.silver.price*e.weight})]}),(x=e.workmanship)==null?void 0:x.map(l=>p("tr",{className:"card-datasheet",children:[t("td",{colSpan:3,children:l.name.toUpperCase()}),t("td",{className:"text-rigth",children:l.value})]},l.name)),p("tr",{className:"card-datasheet",children:[t("td",{colSpan:3,children:"TOTAL"}),t("td",{className:"text-rigth",children:c()})]}),p("tr",{className:"card-datasheet",children:[t("td",{children:"PORCENTAJE"}),t("td",{className:"text-rigth",children:e.expenses}),t("td",{className:"text-rigth",children:c()*e.expenses/100}),t("td",{className:"text-rigth",children:c()*e.expenses/100+c()})]}),p("tr",{className:"card-datasheet",children:[t("td",{colSpan:3,children:"P. VENTA"}),t("td",{className:"text-rigth",children:(c()*e.expenses/100+c())*2})]})]})})})]})},Te=()=>{const e=B(),[a,r]=m.exports.useState([]),[o,s]=m.exports.useState(""),n=async()=>{const i=await P.getAll();i&&r(i)},u=async i=>{await P.delete(i)&&(r(l=>l.filter(g=>g.id!==i)),s(""))},d={cancel:{action:()=>s("")},confirm:{action:i=>u(i)}},c={edit:{icon:f.ICONS.EDIT,action:i=>e(i)},delete:{icon:f.ICONS.DELETE,action:i=>s(i)}};return m.exports.useEffect(()=>{n()},[]),m.exports.useEffect(()=>()=>{q.reset()}),{datasheets:a,deleteDatasheet:o,actionsModal:d,actionsCard:c}};const He=()=>{const{datasheets:e,deleteDatasheet:a,actionsModal:r,actionsCard:o}=Te();return p(z,{children:[t(M,{display:"flex",justifyContent:"flex-end",children:t(F,{to:"new",children:t(W,{title:`${f.CREATE}  ${f.DATASHEET}`,children:t(j,{children:f.ICONS.ADD})})})}),t(M,{display:"flex",flexWrap:"wrap",justifyContent:"center",children:e.map(s=>t(M,{sx:{m:2},children:t(Se,{datasheet:s,actions:o})},s.id))}),a&&t(G,{isOpen:!!a,handlerClose:r.cancel.action,children:p(M,{children:[t(S,{component:"div",sx:{flexGrow:1},children:f.MESSAGE_ACTIONS.DELETE}),t(M,{className:"actions-modal",children:r&&Object.keys(r).map(s=>t(V,{variant:"contained",onClick:()=>r[s].action(a),children:s},s))})]})})]})};export{He as Datasheet};
